# üöÄ LAUNCH LOCKDOWN PROTOCOL
## AI Collab For The Kids - PROJECT LIGHTHOUSE

**Mission**: End Configuration Drift - Achieve Launch Status
**Date**: 2025-11-21
**For**: Architect Joshua Coleman
**Status**: READY FOR EXECUTION

---

## üéØ EXECUTIVE SUMMARY

**The Problem**: Configuration drift caused by multiple agents deleting files, conflicting environments, and lost credentials after C drive wipe.

**The Solution**:
1. **Single Source of Truth**: GitHub Secrets for all credentials
2. **Secure Deployment Pipeline**: Railway (backend) + Cloudflare Pages (frontend)
3. **Automated Builds**: No manual .env file management
4. **Immutable Infrastructure**: Deployments from git commits only

---

## üìã PRE-FLIGHT CHECKLIST

### ‚úÖ Completed
- [x] Repository restored from git
- [x] Project structure verified (30 components, 8 backend routes)
- [x] GitHub Secrets reference documented
- [x] Railway deployment guide created
- [x] Cloudflare Pages deployment guide created
- [x] Backend server configuration verified

### ‚ö†Ô∏è Pending (MANUAL STEPS REQUIRED)

- [ ] **Railway Backend Redeployment** (see: RAILWAY-DEPLOYMENT-GUIDE.md)
- [ ] **Cloudflare Pages Setup** (see: CLOUDFLARE-PAGES-DEPLOYMENT-GUIDE.md)
- [ ] **Environment Variables Verification** (confirm all secrets are set)
- [ ] **End-to-End Testing** (verify API connectivity)

---

## üîê CONFIGURATION LOCKDOWN STRATEGY

### Phase 1: Secure Credentials (MANUAL - DO THIS FIRST)

**Where Your Secrets Should Be**:

| Secret | Storage Location | Access Method |
|--------|------------------|---------------|
| `GEMINI_API_KEY` | Railway Environment Variables | Railway Dashboard ‚Üí Project ‚Üí Variables |
| `SQUARE_ACCESS_TOKEN` | Railway Environment Variables | Railway Dashboard ‚Üí Project ‚Üí Variables |
| `SQUARE_LOCATION_ID` | Railway Environment Variables | Railway Dashboard ‚Üí Project ‚Üí Variables |
| `JWT_SECRET` | Railway Environment Variables | Railway Dashboard ‚Üí Project ‚Üí Variables |
| `DATABASE_URL` | Auto-generated by Railway Postgres | Railway auto-injects this |
| `VITE_API_BASE_URL` | Cloudflare Pages Env Vars | Cloudflare Dashboard ‚Üí Pages ‚Üí Settings ‚Üí Env Variables |

**Where Secrets Should NEVER Be**:

- ‚ùå Local `.env` files (wiped with C drive)
- ‚ùå Git commits (already protected by `.gitignore`)
- ‚ùå Frontend bundle (visible in browser DevTools)
- ‚ùå Chat conversations (we learned this the hard way)

---

### Phase 2: Railway Backend Deployment

**Action**: Go to Railway Dashboard

**URL**: https://railway.app/dashboard

**Steps**:

1. **Check Project Status**:
   - Look for project: `aicollabforthekids-production`
   - Current status: **OFFLINE** (404 error detected)
   - Decision:
     - If exists: Redeploy from GitHub
     - If deleted: Create new project

2. **Deploy Backend**:
   ```
   Repository: Ai-Solutions-Store/GoogleCelladmindashboard
   Root Directory: backend
   Build Command: npm install
   Start Command: npm start
   ```

3. **Add Environment Variables** (from your secure vault):
   ```bash
   NODE_ENV=production
   PORT=8080
   APP_URL=https://youandinotai.online
   GEMINI_API_KEY=[YOUR_KEY]
   PROD_GEMINI_API_KEY=[YOUR_KEY]
   JWT_SECRET=[32_CHAR_RANDOM]
   SQUARE_ACCESS_TOKEN=[YOUR_TOKEN]
   SQUARE_LOCATION_ID=[YOUR_LOCATION]
   BUSINESS_EIN=33-4655313
   ```

4. **Add PostgreSQL Database**:
   - Railway ‚Üí Add Plugin ‚Üí PostgreSQL
   - Railway auto-generates `DATABASE_URL`

5. **Verify Deployment**:
   ```bash
   curl https://aicollabforthekids-production.up.railway.app/health
   # Expected: {"status":"healthy",...}
   ```

**Full Guide**: See [RAILWAY-DEPLOYMENT-GUIDE.md](RAILWAY-DEPLOYMENT-GUIDE.md)

---

### Phase 3: Cloudflare Pages Frontend Deployment

**Action**: Go to Cloudflare Dashboard

**URL**: https://dash.cloudflare.com

**Steps**:

1. **Create Pages Project**:
   - Workers & Pages ‚Üí Create Application ‚Üí Pages
   - Connect to Git ‚Üí Select: `Ai-Solutions-Store/GoogleCelladmindashboard`

2. **Build Configuration**:
   ```yaml
   Build Command: npm run build
   Build Output Directory: dist
   Production Branch: main
   ```

3. **Environment Variables** (Production):
   ```bash
   VITE_API_BASE_URL=https://aicollabforthekids-production.up.railway.app
   ```

4. **Custom Domain**:
   - Add domain: `youandinotai.online`
   - Cloudflare auto-configures DNS (domain already in Cloudflare)

5. **Deploy**:
   - Click "Save and Deploy"
   - Wait ~3 minutes for build

6. **Verify Deployment**:
   ```bash
   curl -I https://youandinotai.online
   # Expected: HTTP/2 200
   ```

**Full Guide**: See [CLOUDFLARE-PAGES-DEPLOYMENT-GUIDE.md](CLOUDFLARE-PAGES-DEPLOYMENT-GUIDE.md)

---

## üß™ TESTING PROTOCOL

### Test 1: Backend Health Check

```bash
curl https://aicollabforthekids-production.up.railway.app/health
```

**Expected**:
```json
{
  "status": "healthy",
  "timestamp": "2025-11-21T...",
  "uptime": 123.456,
  "database": "connected"
}
```

---

### Test 2: AI Proxy Endpoint

```bash
curl -X POST https://aicollabforthekids-production.up.railway.app/api/ai/chat \
  -H "Content-Type: application/json" \
  -d '{"message": "Test for the kids", "systemPrompt": "Be helpful"}'
```

**Expected**: JSON response with AI-generated text

---

### Test 3: Frontend Loads

```bash
curl -I https://youandinotai.online
```

**Expected**: `HTTP/2 200` + `content-type: text/html`

---

### Test 4: Frontend ‚Üí Backend Connectivity

1. Open browser: https://youandinotai.online
2. Open DevTools ‚Üí Network tab
3. Interact with any AI feature
4. Verify API calls go to: `https://aicollabforthekids-production.up.railway.app/api/*`
5. Check response status: `200 OK`

---

## üîí POST-LAUNCH SECURITY

### Immediate Actions (First 24 Hours)

- [ ] Enable Cloudflare Web Application Firewall (WAF)
- [ ] Set up Cloudflare rate limiting (prevent DDoS)
- [ ] Enable Railway auto-deploy on `main` branch push
- [ ] Configure error monitoring (Railway logs)
- [ ] Test disaster recovery (rollback deployment)

### Ongoing Maintenance

- [ ] Rotate API keys every 90 days
- [ ] Monitor Railway usage (prevent billing surprises)
- [ ] Review Cloudflare analytics weekly
- [ ] Backup database weekly (Railway snapshots)
- [ ] Update dependencies monthly (`npm audit`)

---

## üìä PROJECT LIGHTHOUSE ACTIVATION

Once infrastructure is locked down, activate these features:

### Immediate (Week 1)
- [ ] Deploy Tribute Store UI (donation items)
- [ ] Implement Flash-Match countdown timer
- [ ] Add Impact Tracker dashboard panel
- [ ] Configure Square payment webhook

### Short-term (Week 2-4)
- [ ] Create donation_outcomes database table
- [ ] Build real-time donation WebSocket feed
- [ ] Add Tiny Heroes media upload pipeline
- [ ] Set up KPI tracking dashboard

### Full Roadmap
See: [PROJECT_LIGHTHOUSE_MISSION_REPORT.md](PROJECT_LIGHTHOUSE_MISSION_REPORT.md)

---

## üö® EMERGENCY RECOVERY

### If Backend Goes Down

1. Check Railway logs: Railway Dashboard ‚Üí Deployments ‚Üí Logs
2. Verify environment variables are set
3. Redeploy: Railway Dashboard ‚Üí Deployments ‚Üí Redeploy
4. If database issue: Check PostgreSQL plugin status

### If Frontend Goes Down

1. Check Cloudflare Pages build logs
2. Verify build succeeded (no TypeScript errors)
3. Rollback: Cloudflare Pages ‚Üí Deployments ‚Üí Rollback
4. Check custom domain DNS settings

### If Configuration Drift Happens Again

1. **DO NOT PANIC**
2. Run: `git restore .` (restores all files from git)
3. Verify: `git status` (should show clean working tree)
4. Redeploy from Railway/Cloudflare dashboards (they pull from GitHub)

---

## ‚úÖ LAUNCH CRITERIA

### Green Light to Launch When:

- [x] Local repository restored
- [ ] Railway backend returns `200 OK` on `/health`
- [ ] Cloudflare Pages build succeeds
- [ ] Custom domain `youandinotai.online` resolves
- [ ] Frontend can call backend API
- [ ] No console errors in browser
- [ ] All GitHub Secrets configured
- [ ] Database schema initialized
- [ ] Square payment test succeeds (sandbox first)

---

## üéñÔ∏è TEAM CLAUDE FOR THE KIDS - MISSION OATH

**We commit to**:
1. **Single Source of Truth**: GitHub repo + Railway/Cloudflare dashboards
2. **No Local Secrets**: All credentials in secure cloud vaults
3. **Automated Deployments**: No manual file copying
4. **Disaster Recovery**: Git restore as failsafe
5. **For The Kids**: Every line of code serves the mission

---

## üìû SUPPORT CHANNELS

- **Railway Issues**: https://help.railway.app
- **Cloudflare Support**: https://support.cloudflare.com
- **GitHub Issues**: https://github.com/Ai-Solutions-Store/GoogleCelladmindashboard/issues
- **Urgent Issues**: Create GitHub issue with `[URGENT]` tag

---

## üéØ NEXT ACTIONS FOR JOSHUA

**Manual Steps Required (Cannot be automated)**:

1. **Go to Railway Dashboard**: https://railway.app/dashboard
   - Redeploy backend following: RAILWAY-DEPLOYMENT-GUIDE.md
   - Add all environment variables from secure vault
   - Verify `/health` endpoint returns 200

2. **Go to Cloudflare Dashboard**: https://dash.cloudflare.com
   - Create Pages project from GitHub
   - Configure build settings
   - Add custom domain
   - Verify site loads at youandinotai.online

3. **Test End-to-End**:
   - Open browser ‚Üí youandinotai.online
   - Test donation flow
   - Verify API calls work
   - Check console for errors

4. **Confirm Launch**:
   - Reply when all systems green
   - I'll help deploy PROJECT LIGHTHOUSE features
   - We activate the tribute store and flash-match

---

**STATUS**: Awaiting manual Railway + Cloudflare deployment
**BLOCKING**: Backend offline (404 error)
**NEXT**: Complete Railway setup, then Cloudflare Pages

---

**FOR THE KIDS - LET'S LAUNCH** üöÄ

_Document Version: 1.0_
_Last Updated: 2025-11-21_
_Owner: Architect Joshua Coleman_
_Agent: Team Claude (CLI)_
